<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>EveryoneIsTheProductManager_Note_V1</title>
    <url>/2024/03/25/EveryoneIsTheProductManager-Note-V1/</url>
    <content><![CDATA[<h2 id="åŸºæœ¬ä¿¡æ¯"><a href="#åŸºæœ¬ä¿¡æ¯" class="headerlink" title="åŸºæœ¬ä¿¡æ¯"></a>åŸºæœ¬ä¿¡æ¯</h2><p><strong>ä¹¦åï¼š</strong>ã€Šäººäººéƒ½æ˜¯äº§å“ç»ç†ã€‹<br><strong>é˜…è¯»æ—¥æœŸï¼š</strong>2024&#x2F;03&#x2F;02-2024&#x2F;03&#x2F;12<br><strong>é˜…è¯»æ¬¡æ•°ï¼š</strong> 1</p>
<hr>
<h2 id="ç¬¬ä¸€æ¬¡é˜…è¯»ç¬”è®°"><a href="#ç¬¬ä¸€æ¬¡é˜…è¯»ç¬”è®°" class="headerlink" title="ç¬¬ä¸€æ¬¡é˜…è¯»ç¬”è®°"></a>ç¬¬ä¸€æ¬¡é˜…è¯»ç¬”è®°</h2><hr>
<span id="more"></span>

<h3 id="Chap-One-â€“-éœ€æ±‚"><a href="#Chap-One-â€“-éœ€æ±‚" class="headerlink" title="Chap_One â€“ éœ€æ±‚"></a>Chap_One â€“ éœ€æ±‚</h3><p>ä»ã€Šè¥é”€ç®¡ç†ã€‹ç­‰ä¸€ç³»åˆ—ä¹¦ç±ä¸å•†ä¸šæ¡ˆä¾‹ä¸­ï¼Œéƒ½å¯å¾—çŸ¥ç”¨æˆ·éœ€æ±‚å¯¹äºä¸€ä¸ªäº§å“çš„å¿…è¦æ€§</p>
<img src="/images/Note/IMG_4249.jpg" title="Chap_One_Img_1">
<img src="/images/Note/IMG_4250.jpg" title="Chap_One_Img_2">

<h3 id="Chap-Two-â€“-é¡¹ç›®ç®¡ç†"><a href="#Chap-Two-â€“-é¡¹ç›®ç®¡ç†" class="headerlink" title="Chap_Two â€“ é¡¹ç›®ç®¡ç†"></a>Chap_Two â€“ é¡¹ç›®ç®¡ç†</h3><p>äº§å“æ˜¯æœ‰ä¸€ä¸ªä¸ªçš„å¤§å¤§å°å°çš„é¡¹ç›®æ„æˆï¼Œé¡¹ç›®ç®¡ç†èƒ½åŠ›æ˜¯ä¸€ä¸ªä¼˜ç§€çš„äº§å“ç»ç†å¿…å¤‡çš„èƒ½åŠ›</p>
<img src="/images/Note/IMG_4251.jpg" title="Chap_Two_Img_1">
<img src="/images/Note/IMG_4252.jpg" title="Chap_Two_Img_2">
<img src="/images/Note/IMG_4253.jpg" title="Chap_Two_Img_3">

<h3 id="Chap-Four-â€“-æˆ˜ç•¥ä¸é¢†å¯¼åŠ›"><a href="#Chap-Four-â€“-æˆ˜ç•¥ä¸é¢†å¯¼åŠ›" class="headerlink" title="Chap_Four â€“ æˆ˜ç•¥ä¸é¢†å¯¼åŠ›"></a>Chap_Four â€“ æˆ˜ç•¥ä¸é¢†å¯¼åŠ›</h3><p>äº§å“å›¢é˜Ÿæ˜¯ä¸€ä¸ªäº§å“å¾—ä»¥å‘å±•å»¶ç»­çš„æœ¬æºåŠ¨åŠ›ï¼Œäº§å“æ˜¯å…³ä¹æ‰€æœ‰ç›¸å…³äººå‘˜çš„äº‹æƒ…</p>
<img src="/images/Note/IMG_4254.jpg" title="Chap_Four_Img_1">
<img src="/images/Note/IMG_4255.jpg" title="Chap_Four_Img_2">

<h3 id="Chap-Five-â€“-ä»·å€¼è§‚"><a href="#Chap-Five-â€“-ä»·å€¼è§‚" class="headerlink" title="Chap_Five â€“ ä»·å€¼è§‚"></a>Chap_Five â€“ ä»·å€¼è§‚</h3><p>ä¸€ä¸ªæœ‰æˆ˜æ–—åŠ›çš„å›¢é˜Ÿï¼Œæ˜¯ç¦»ä¸å¼€ä¸€ä¸ªç»Ÿä¸€çš„æ€æƒ³ä¸ç›®æ ‡çš„æŒ‡å¯¼</p>
<img src="/images/Note/IMG_4256.jpg" title="Chap_Five_Img_1">
<img src="/images/Note/IMG_4257.jpg" title="Chap_Five_Img_2">

<h3 id="Chap-Six-â€“-PMçš„ç´ å…»"><a href="#Chap-Six-â€“-PMçš„ç´ å…»" class="headerlink" title="Chap_Six â€“ PMçš„ç´ å…»"></a>Chap_Six â€“ PMçš„ç´ å…»</h3><p>PMå¯¹åº”çš„ç´ å…»ã€æ‰èƒ½ï¼Œèƒ½å¤Ÿå¸®åŠ©PMå‘æŒ¥ç›¸åº”çš„æˆ˜æ–—åŠ›</p>
<img src="/images/Note/IMG_4258.jpg" title="Chap_Six_Img_1">
<img src="/images/Note/IMG_4259.jpg" title="Chap_Six_Img_2">

<h3 id="ä¸è¶³ç‚¹"><a href="#ä¸è¶³ç‚¹" class="headerlink" title="ä¸è¶³ç‚¹"></a>ä¸è¶³ç‚¹</h3><img src="/images/Note/IMG_4260.jpg" title="Spport">]]></content>
      <categories>
        <category>LearningNote</category>
        <category>PM</category>
      </categories>
      <tags>
        <tag>å­¦ä¹ ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>IE_Race</title>
    <url>/2024/03/26/IE-Race/</url>
    <content><![CDATA[<h2 id="é¡¹ç›®åŸç†"><a href="#é¡¹ç›®åŸç†" class="headerlink" title="é¡¹ç›®åŸç†"></a>é¡¹ç›®åŸç†</h2><pre><code>åŸºäºèåˆå­¦ä¹ ï¼Œè¿›è¡Œæ¸¸æˆå…¬å¸ç©å®¶æµå¤±é‡é¢„æµ‹
</code></pre>
<span id="more"></span>
<h3 id="æŠ€æœ¯æ–¹æ¡ˆè®¡åˆ’ä¹¦"><a href="#æŠ€æœ¯æ–¹æ¡ˆè®¡åˆ’ä¹¦" class="headerlink" title="æŠ€æœ¯æ–¹æ¡ˆè®¡åˆ’ä¹¦"></a>æŠ€æœ¯æ–¹æ¡ˆè®¡åˆ’ä¹¦</h3><iframe src="/images/Project/IE-Race/åŸºäºæŠ•ç¥¨çš„é›†æˆå­¦ä¹ æ¨¡å‹_10-8.pdf">]]></content>
      <tags>
        <tag>é¡¹ç›®å®è·µ</tag>
      </tags>
  </entry>
  <entry>
    <title>ReinforceLearning_Note_V1</title>
    <url>/2024/03/25/ReinforceLearning-Note-V1/</url>
    <content><![CDATA[<h2 id="DeepReinforceLearning"><a href="#DeepReinforceLearning" class="headerlink" title="DeepReinforceLearning"></a>DeepReinforceLearning</h2><p>ä¸»è¦ä»‹ç»æ·±åº¦å¼ºåŒ–å­¦ä¹ ä¸­çš„DQnã€æ¢¯åº¦ç­–ç•¥ä¸AlphaGoåŠAlphaGo Zero</p>
<span id="more"></span>

<h3 id="DQN"><a href="#DQN" class="headerlink" title="DQN:"></a>DQN:</h3><pre><code>Use neural network ğ‘„(ğ‘ ,ğ‘;ğ°) to approximate ğ‘„â‹†(ğ‘ ,ğ‘).to select the best/most valuable actiton in this state

Q-function to subscribe the value of action in the real world.

Temporal Difference (TD) Learning to make the action evaluation function Q become more accurate.

    cause	ğ‘ˆt = ğ‘…t + ğ›¾â‹…ğ‘ˆt+1 .
    prediction ğ‘„(ğ‘ t,ğ‘t;ğ°t)
    loss	Lt = 1/2*[ğ‘„(ğ‘ t,ğ‘t;ğ°t) - yt]^2
    Gradient descent wt+1 = wt - alpha*(dLt / dw)|w=wt

    DQN : off-policy like the &quot;behavior cloning&quot; thinking
</code></pre>
<h3 id="Policy-Gradient"><a href="#Policy-Gradient" class="headerlink" title="Policy Gradient:"></a>Policy Gradient:</h3><pre><code>Neural network to approximate Value and Policy, make the value evaluation function more accurancy and the policy preform better.

    ğ‘‰(ğ‘ ) =âˆ‘ğ‘ ğœ‹(ğ‘,ğ‘ )â‹…ğ‘„ğœ‹(ğ‘ ,ğ‘) . contain: actor &amp; critic
    
    ğœ‹(ğ‘,ğ‘ ;ğ›‰) -&gt; ğœ‹(ğ‘,ğ‘ ); ğ‘(ğ‘ ,ğ‘;ğ°) -&gt; ğ‘(ğ‘ ,ğ‘)
    
    ğ‘‰(ğ‘ ;ğ›‰,ğ°) = âˆ‘ğ‘ ğœ‹(ğ‘,ğ‘ ;ğ›‰)ğ‘(ğ‘ ,ğ‘;ğ°)

    ğ (ğ‘,ğ›‰) = [dlogğœ‹(ğ‘,ğ‘ ;ğ›‰)/dğ›‰]â€¢ğ‘(ğ‘ ,ğ‘;ğ°)

    dğ‘‰(ğ‘ ;ğ›‰,ğ°)/dğ›‰ =ğ”¼ğ´[ğ (ğ´,ğ›‰)] &#123;cause ğœ‹ is probability density function&#125;

    as for the critic use the TD to update ğ°
</code></pre>
<h3 id="AlphaGoï¼ˆMCTSï¼‰"><a href="#AlphaGoï¼ˆMCTSï¼‰" class="headerlink" title="AlphaGoï¼ˆMCTSï¼‰"></a>AlphaGoï¼ˆMCTSï¼‰</h3><pre><code>For the Monte Carlo Tree Search trained AlphaGO Zero, it has 4 steps:
    1. Selection: The player makes an action ğ‘. (Imaginary action; not actual move.)

    2. Expansion: The opponent makes an action; the state updates. (Also imaginary action; made by the policy network.)

    3. Evaluation: Evaluate the state-value and get score ğ‘£. Play the game to the end to receive reward ğ‘Ÿ. Assign score (ğ‘£+ğ‘Ÿ)/2

    4. Backup: Use the score (ğ‘£+ğ‘Ÿ)/2 to action ğ‘. to update action-values.
</code></pre>
]]></content>
      <categories>
        <category>LearningNote</category>
        <category>RL</category>
      </categories>
      <tags>
        <tag>å­¦ä¹ ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>CrawlerOnWeibo</title>
    <url>/2024/03/25/crawler-form-weibo/</url>
    <content><![CDATA[<p><strong>é¡¹ç›®èƒŒæ™¯ï¼š</strong>å‡ºäºéœ€æ±‚å¾®åšéƒ¨åˆ†å¤§Væé—®ä¿¡æ¯ã€é—®é¢˜ä»·å€¼ã€é—®é¢˜å›å¤ä»¥åŠå¯¹åº”å›ç­”äººå‘˜çš„ä¿¡æ¯çš„çˆ¬å–ç”¨äºç§‘ç ”ï¼Œä¸æ¶‰åŠååçˆ¬å†…å®¹ï¼Œä»…ç”¨æœ€åŸºæœ¬åŠŸèƒ½ç­‰ã€‚<br><strong>Based on:</strong> Python 3.8</p>
<hr>
<span id="more"></span>

<h2 id="Quite-Start"><a href="#Quite-Start" class="headerlink" title="Quite Start"></a>Quite Start</h2><hr>
<h3 id="Page-One-Get"><a href="#Page-One-Get" class="headerlink" title="Page One Get"></a>Page One Get</h3><pre><code>ä»EXCELä¸­è¯»å–å¯¹åº”å¤§Vçš„é—®ç­”é“¾æ¥ï¼Œè¿›è¡Œå…¶æ‰€æœ‰é—®ç­”é“¾æ¥çš„çˆ¬å–
</code></pre>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line">from openpyxl import Workbook</span><br><span class="line">from openpyxl import load_workbook</span><br><span class="line"># import pymysql</span><br><span class="line">import pandas as pd</span><br><span class="line"></span><br><span class="line">#è¯·æ±‚å¤´</span><br><span class="line">headers = &#123;</span><br><span class="line">    &#x27;User-Agent&#x27;: &#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.182 Safari/537.36&#x27;,</span><br><span class="line">    &#x27;Referer&#x27;: &#x27;https://m.weibo.cn/&#x27;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># å®šä¹‰å‡½æ•°è·å–å¤šé¡µæ•°æ®ï¼Œä¸¤ä¸ªå‚æ•°åˆ†åˆ«æ˜¯ä¸‹ä¸€é¡µé¢çš„since_idå’Œçˆ¬å–çš„åšä¸»ID</span><br><span class="line">def get_page(since_id,bigV_id):</span><br><span class="line">    #urlå˜åŒ–çš„éƒ¨åˆ†å›ºå®šä¸ºä¼ å…¥çš„ä¸¤ä¸ªå‚æ•°çš„å­—ç¬¦ä¸²æ ¼å¼str()</span><br><span class="line">    url = &#x27;https://m.weibo.cn/api/container/getIndex?containerid=231068_-_QUESTIONLIST&amp;extparam=&#x27; + str(bigV_id) + &#x27;&amp;since_id=&#x27; + str(since_id)</span><br><span class="line">    try:</span><br><span class="line">        #è·å–é¡µé¢çš„è¯·æ±‚è®¸å¯</span><br><span class="line">        response = requests.get(url, headers=headers)</span><br><span class="line">        #å¦‚æœè¯·æ±‚è¿”å›çŠ¶æ€ç ä¸º200è¡¨ç¤ºè®¸å¯</span><br><span class="line">        if response.status_code == 200:</span><br><span class="line">            #ä»¥jsonæ–‡ä»¶è§£æè¯·æ±‚æ•°æ®åŒ…</span><br><span class="line">            json = response.json()</span><br><span class="line">            if json[&#x27;ok&#x27;] == 1:</span><br><span class="line">                #å¦‚æœæˆåŠŸåˆ™è·å–jsonæ–‡ä»¶ä¸­çš„cardlistInfoä¸‹çš„since_id</span><br><span class="line">                next_since_id = json.get(&#x27;data&#x27;).get(&#x27;cardlistInfo&#x27;)[&#x27;since_id&#x27;]</span><br><span class="line">                #è¿”å›ä¸‹ä¸€é¡µé¢çš„since</span><br><span class="line">                return (json, next_since_id)</span><br><span class="line">            else:</span><br><span class="line">                return None</span><br><span class="line">    #ä¸‹é¢æ˜¯å‡ºé”™é€€å‡ºè¿”å›</span><br><span class="line">    except requests.ConnectionError as e:</span><br><span class="line">        print(&#x27;Error&#x27;, e.args)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#æ­¤ä»£ç å®šä¹‰å‡½æ•°run()æ¥è·å–éœ€è¦çš„æ•°æ®ï¼Œä¼ å…¥å‚æ•°ä¸ºéœ€è¦çˆ¬å–çš„å¾®åšç”¨æˆ·</span><br><span class="line">def run(bigV_id):</span><br><span class="line">    # åˆ›å»ºä¸€ä¸ªæ–°çš„Excelå·¥ä½œç°¿ï¼Œè®¾ç½®åˆ—åç§°ï¼Œå’Œå·¥ä½œè¡¨å</span><br><span class="line">    newWb = Workbook()</span><br><span class="line">    newWs = newWb.create_sheet(&#x27;1&#x27;, 0)</span><br><span class="line">    # æ·»åŠ è¡¨å¤´</span><br><span class="line">    newWs.append([&#x27;uid&#x27;, &#x27;asker_id&#x27;, &#x27;name_ask&#x27;, &#x27;avatar&#x27;, &#x27;onlookers&#x27;, &#x27;brief_ques&#x27;, &#x27;value&#x27;, &#x27;detailed_url&#x27;])</span><br><span class="line">    #è®¾ç½®ä¸€ä¸ªå€¼è¡¨ç¤ºå½“å‰é¡µé¢ï¼Œåˆå§‹ä¸º0</span><br><span class="line">    i = 0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    # while True:</span><br><span class="line">    while True:</span><br><span class="line">        if i == 0: # æœªæ»šåŠ¨ï¼Œå½“å‰ä¸ºåˆå§‹é¡µé¢</span><br><span class="line">            #åˆ›å»ºå…ƒç»„tuple_since_idå­˜å½“å‰åˆå§‹é¡µé¢çš„æ•°æ®</span><br><span class="line">            tuple_since_id = get_page(&#x27;&#x27;,bigV_id)</span><br><span class="line">            # é¡µé¢åŠ ä¸€</span><br><span class="line">            i+=1</span><br><span class="line">        #å¦‚æœå·²ç»ä¸æ˜¯åˆå§‹é¡µé¢ï¼Œå¼€å§‹æ•°æ®æœé›†</span><br><span class="line">        else:</span><br><span class="line"></span><br><span class="line">            tuple_since_id = get_page(tuple_since_id[1],bigV_id)</span><br><span class="line"></span><br><span class="line">            if tuple_since_id: # å¦‚æœè·å–å…ƒç»„æ•°æ®</span><br><span class="line">                print(tuple_since_id[1])</span><br><span class="line"></span><br><span class="line">                # æ£€æŸ¥æ–°çš„ since_id æ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœæ˜¯ï¼Œè¯´æ˜åªæœ‰ä¸€ä¸ªé¡µé¢ï¼Œåªè·å–ä¸€æ¬¡æ•°æ®ç”¨breakç»“æŸ</span><br><span class="line">                if tuple_since_id[1] ==&#x27;&#x27;:#è¿™é‡Œæ˜¯å•é¡µé¢çš„æ¡ä»¶ï¼Œsince_id=&#x27;&#x27;</span><br><span class="line">                    #è·å–å…ƒç»„å†…çš„æ•°æ®è§£æjson</span><br><span class="line">                    json = tuple_since_id[0]</span><br><span class="line">                    # è§£æJSONæ•°æ®æå–æ‰€éœ€ä¿¡æ¯ï¼Œæˆ‘ä»¬éœ€è¦çš„äº‹data,cardä¸­çš„éƒ¨åˆ†æ•°æ®</span><br><span class="line">                    cards = json[&#x27;data&#x27;][&#x27;cards&#x27;]</span><br><span class="line">                    #éå†cardä¸­çš„æ•°æ®ï¼ŒæŒ¨ä¸ªè·å–</span><br><span class="line">                    for card in cards:</span><br><span class="line">                        #è¦çš„äº‹cardä¸­çš„cardgroupçš„æ•°æ®</span><br><span class="line">                        if &#x27;card_group&#x27; in card:</span><br><span class="line">                            row = []  # å»ºç«‹ä¸€ä¸ªä»·rowçš„åˆ—è¡¨ï¼Œç”¨äºå­˜å‚¨åˆå¹¶åçš„ä¸€è¡Œæ•°æ®</span><br><span class="line">                            # éå†cardgroupä¸­çš„æ•°æ®ï¼ŒæŒ¨ä¸ªè·å–</span><br><span class="line">                            for item in card[&#x27;card_group&#x27;]:</span><br><span class="line">                                #éœ€è¦card_type==93ä¸‹çš„æ•°æ®</span><br><span class="line">                                if item[&#x27;card_type&#x27;] == 93:</span><br><span class="line">                                    #è·å–userçš„id</span><br><span class="line">                                    user = item[&#x27;user&#x27;]</span><br><span class="line">                                    if user:#å¦‚æœè·å–åˆ°</span><br><span class="line">                                        #åˆ—è¡¨ä¸­çš„æ•°æ®å¯¹åº”è¿ç»­æ·»åŠ åˆ°Excelçš„åˆ—ä¸­ï¼Œsplitæ˜¯å¿…è¦çš„å†…å®¹åˆ‡åˆ†åªè·å–éœ€è¦çš„</span><br><span class="line">                                        row.extend([bigV_id, user[&#x27;id&#x27;], user[&#x27;screen_name&#x27;], user[&#x27;profile_image_url&#x27;],</span><br><span class="line">                                                    item[&#x27;status&#x27;].split(&#x27;&lt;/font&gt;&lt;font&#x27;)[0].split(&#x27;&gt;&#x27;)[-1]])</span><br><span class="line">                                    else:#å¦‚æœæ²¡æœ‰å°±ç½®ç©º</span><br><span class="line">                                        row.extend([&#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;])</span><br><span class="line">                                #ä¸‹é¢åŒç†ä¹Ÿæ˜¯è·å–cardçš„æ•°æ®</span><br><span class="line">                                elif item[&#x27;card_type&#x27;] == 8:</span><br><span class="line">                                    row.extend([item[&#x27;title_sub&#x27;], item[&#x27;desc1&#x27;], item[&#x27;scheme&#x27;]])</span><br><span class="line">                                    print(item[&#x27;title_sub&#x27;])</span><br><span class="line">                            newWs.append(row)#å¢åŠ æ–°çš„ä¸€è¡Œ</span><br><span class="line">                    print(&quot;ä¸€é¡µçš„æ•°æ®è·å–å®Œæ¯•ï¼Œç»“æŸ&quot;)</span><br><span class="line">                    #å•é¡µé¢çš„æ•°æ®è·å–å®Œæ¯•ï¼Œç»“æŸ</span><br><span class="line">                    break</span><br><span class="line"></span><br><span class="line">                #æ¥ä¸‹æ¥å°±æ˜¯è·å–éœ€è¦æ»šåŠ¨åŠ è½½çš„å¤šé¡µé¢åŒ…çš„æ•°æ®ï¼Œé€»è¾‘ä¸€è‡´,åªæ˜¯æ²¡æœ‰ç»“æŸæ¡ä»¶</span><br><span class="line">                else:</span><br><span class="line"></span><br><span class="line">                    json = tuple_since_id[0]</span><br><span class="line">                    # è§£æJSONæ•°æ®æå–æ‰€éœ€ä¿¡æ¯</span><br><span class="line">                    cards = json[&#x27;data&#x27;][&#x27;cards&#x27;]</span><br><span class="line">                    for card in cards:</span><br><span class="line">                        if &#x27;card_group&#x27; in card:</span><br><span class="line">                            row = []  # ç”¨äºå­˜å‚¨åˆå¹¶åçš„ä¸€è¡Œæ•°æ®</span><br><span class="line">                            for item in card[&#x27;card_group&#x27;]:</span><br><span class="line">                                if item[&#x27;card_type&#x27;] == 93:</span><br><span class="line">                                    user = item[&#x27;user&#x27;]</span><br><span class="line">                                    if user:</span><br><span class="line">                                        row.extend([bigV_id,user[&#x27;id&#x27;], user[&#x27;screen_name&#x27;], user[&#x27;profile_image_url&#x27;],item[&#x27;status&#x27;].split(&#x27;&lt;/font&gt;&lt;font&#x27;)[0].split(&#x27;&gt;&#x27;)[-1]])</span><br><span class="line">                                    else:</span><br><span class="line">                                        row.extend([&#x27;&#x27;,&#x27;&#x27;,&#x27;&#x27;,&#x27;&#x27;])</span><br><span class="line">                                elif item[&#x27;card_type&#x27;] == 8:</span><br><span class="line">                                    row.extend([item[&#x27;title_sub&#x27;], item[&#x27;desc1&#x27;], item[&#x27;scheme&#x27;]])</span><br><span class="line">                                    print(item[&#x27;title_sub&#x27;])</span><br><span class="line">                            newWs.append(row)</span><br><span class="line"></span><br><span class="line">            else:</span><br><span class="line">                break</span><br><span class="line">        # æ»šåŠ¨åˆ°åº•è·³å‡ºå¾ªç¯</span><br><span class="line"></span><br><span class="line">    #Excelè¡¨æ ¼ä¿å­˜save()å‡½æ•°ï¼Œå‘½åä¸ºç”¨æˆ·å.xlsx</span><br><span class="line">    newWb.save(str(bigV_id) + &#x27;.xlsx&#x27;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#mainå‡½æ•°ï¼Œè¯´æ˜è¿™ä¸ªå·¥ä½œè¡¨çš„è·¯å¾„å’Œè¦å¤„ç†çš„å¼€å§‹è¡Œ</span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    file_path = r&quot;./merged_file.xlsx&quot;</span><br><span class="line"></span><br><span class="line">    # è¯»å–Excelæ–‡ä»¶çš„ç¬¬2è¡Œçš„ç¬¬ä¸€åˆ—æ•°æ®</span><br><span class="line">    df = pd.read_excel(file_path, usecols=[0], header=None)</span><br><span class="line">    ids = df.iloc[305:350, 0].tolist()</span><br><span class="line">    print(ids)</span><br><span class="line">    #è°ƒç”¨run()å‡½æ•°</span><br><span class="line">    # run(1990466285)</span><br><span class="line">    #</span><br><span class="line"></span><br><span class="line">    # #è°ƒç”¨run()å‡½æ•°</span><br><span class="line">    for id in ids:</span><br><span class="line">        run(id)</span><br></pre></td></tr></table></figure>

<h3 id="Page-Two-Get"><a href="#Page-Two-Get" class="headerlink" title="Page Two Get"></a>Page Two Get</h3><pre><code>ä»ä¸Šè¿°ä»£ç è·å¾—é—®ç­”è¯¦ç»†é“¾æ¥åè¿›è¡Œä¸‹ä¸€æ­¥é—®ç­”è¯¦ç»†ä¿¡æ¯æå–
</code></pre>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># ä½¿ç”¨importå¯¼å…¥requestsæ¨¡å—</span><br><span class="line">import time</span><br><span class="line">import re</span><br><span class="line">import pandas as pd</span><br><span class="line">import requests</span><br><span class="line">from openpyxl import load_workbook</span><br><span class="line"># ä»bs4ä¸­å¯¼å…¥BeautifulSoup</span><br><span class="line">from bs4 import BeautifulSoup</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def run(name: str):</span><br><span class="line">    # æ‰“å¼€Excelæ–‡ä»¶</span><br><span class="line">    # é€šè¿‡ load_workbook å‡½æ•°æ‰“å¼€æŒ‡å®šçš„ Excel æ–‡ä»¶ï¼Œå¹¶è·å–æ´»åŠ¨å·¥ä½œè¡¨ ws</span><br><span class="line">    # æ³¨æ„æ¯æ¬¡å¤„ç†çš„æ—¶å€™ä¿®æ”¹å·¥ä½œè¡¨åå­—ï¼Œæ¯”å¦‚å½“å‰çš„å·¥ä½œè¡¨åä¸ºâ€œtest_1.xlsxâ€</span><br><span class="line">    # excel_name = &#x27;test_1.xlsx&#x27;</span><br><span class="line"></span><br><span class="line">    count = 0</span><br><span class="line"></span><br><span class="line">    excel_name = name</span><br><span class="line"></span><br><span class="line">    wb = load_workbook(excel_name)</span><br><span class="line">    ws = wb.active</span><br><span class="line"></span><br><span class="line">    # éå†Excelé‡Œé¢çš„æ‰€æœ‰å·¥ä½œè¡¨</span><br><span class="line">    for ws in wb.worksheets:</span><br><span class="line">        print(&quot;å½“å‰å·¥ä½œè¡¨åç§°ï¼š&quot;, ws.title)</span><br><span class="line">        # è·å–å·¥ä½œè¡¨çš„æœ€å¤§åˆ—æ•°</span><br><span class="line">        max_column = ws.max_column</span><br><span class="line">        # è®¾ç½®è¡¨å¤´ï¼Œæ·»åŠ ä¸‰åˆ—</span><br><span class="line">        ws.cell(row=1, column=9, value=&#x27;time_ask&#x27;)</span><br><span class="line">        ws.cell(row=1, column=10, value=&#x27;time_ans&#x27;)</span><br><span class="line">        ws.cell(row=1, column=11, value=&#x27;ques&#x27;)</span><br><span class="line"></span><br><span class="line">        # ç”¨å‡½æ•°enumerateè·å–åˆ—ç´¢å¼•ï¼ˆå½“å‰åˆ—ï¼‰ï¼Œå’Œéœ€è¦è¯»å–çš„åˆ—ï¼Œè§„å®šä»ç¬¬äºŒè¡Œå¼€å§‹</span><br><span class="line">        for col_index, col in enumerate(ws.iter_cols(min_col=8, max_col=8, min_row=2, values_only=True), start=2):</span><br><span class="line">            # æ¯ä¸€è¡Œçš„å½“å‰è¡Œæ•°ï¼Œè·å–page_idï¼Œä»ç¬¬äºŒè¡Œå¼€å§‹</span><br><span class="line">            for row_index, page_id in enumerate(col, start=2):</span><br><span class="line">                # page_idä¸ºäºŒçº§é¡µé¢éœ€è¦çš„url</span><br><span class="line">                if page_id == &#x27; &#x27;:</span><br><span class="line">                    break</span><br><span class="line">                print(&quot;å…ƒç´ æ‰€åœ¨è¡Œï¼š&quot;, row_index)</span><br><span class="line"></span><br><span class="line">                # å°†è¡¨æ ¼ä¸­çš„page_idä¼ ç»™url</span><br><span class="line">                url = f&#x27;&#123;page_id&#125;&#x27;</span><br><span class="line"></span><br><span class="line">                # è¯·æ±‚å¤´</span><br><span class="line">                headers = &#123;</span><br><span class="line">                    &quot;User-Agent&quot;: &#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36&#x27;,</span><br><span class="line">                    # &#x27;Referer&#x27;: &#x27;https://media.weibo.cn/api/wenda?&#x27;,</span><br><span class="line">                    # è¡¥å……ä½ çš„cookie</span><br><span class="line">                    &quot;Cookie&quot;: &quot;&quot;</span><br><span class="line">                &#125;</span><br><span class="line">                # è·å–åé¦ˆ</span><br><span class="line">                response = requests.get(url, headers=headers)</span><br><span class="line">                # è§£ç ï¼Œé˜²æ­¢ä¸­æ–‡ä¹±ç </span><br><span class="line">                response.encoding = response.apparent_encoding</span><br><span class="line"></span><br><span class="line">                if response.status_code == 200:</span><br><span class="line"></span><br><span class="line">                    # å°†æœåŠ¡å™¨å“åº”å†…å®¹è½¬æ¢ä¸ºå­—ç¬¦ä¸²å½¢å¼ï¼Œèµ‹å€¼ç»™html</span><br><span class="line">                    html = response.text</span><br><span class="line">                    # print(html)</span><br><span class="line">                    # ä½¿ç”¨BeautifulSoup()ä¼ å…¥å˜é‡htmlå’Œè§£æå™¨lxmlï¼Œèµ‹å€¼ç»™soup</span><br><span class="line">                    soup = BeautifulSoup(html, &quot;lxml&quot;)</span><br><span class="line">                    # ä½¿ç”¨find_all()æŸ¥è¯¢soupä¸­class=&quot; &quot;çš„èŠ‚ç‚¹</span><br><span class="line"></span><br><span class="line">                    # è·å–titleç»“æ„ä¸‹çš„å†…å®¹ï¼Œå³ä¸ºéœ€è¦çš„è¯¦ç»†è¯„è®º</span><br><span class="line">                    content_all = soup.find_all(&quot;title&quot;)</span><br><span class="line"></span><br><span class="line">                    for content in content_all:</span><br><span class="line">                        # è·å–å†…å®¹</span><br><span class="line">                        text = content.text</span><br><span class="line">                        if &#x27;æŠ±æ­‰ï¼Œå‡ºé”™äº†&#x27; in text:</span><br><span class="line">                            text = &#x27;åšä¸»è®¾ç½®æ— æ³•æŸ¥çœ‹&#x27;</span><br><span class="line">                            count += 1</span><br><span class="line">                        print(text)</span><br><span class="line">                        # ä½ è¦æ’å…¥çš„è¡Œå·ï¼Œåœ¨ä¸€å¼€å§‹æˆ‘ä»¬è·å–åˆ°çš„row_index</span><br><span class="line">                        row_number = row_index</span><br><span class="line">                        # å°†æé—®çš„æ—¶é—´å¡«å†™åˆ°å¯¹åº”è¡Œçš„ç¬¬11åˆ—å•å…ƒæ ¼ä¸­,æ ¹æ®è¡¨æ ¼è°ƒæ•´</span><br><span class="line">                        ws.cell(row=row_number, column=11, value=text)</span><br><span class="line">                        # ä¿å­˜å·¥ä½œè¡¨</span><br><span class="line">                        wb.save(excel_name)</span><br><span class="line"></span><br><span class="line">                    # è·å–æé—®æ—¶é—´å’Œå›ç­”æ—¶é—´ï¼Œæ˜¯æ ‡è®°åœ¨DIVä¸­é—´ï¼ŒCLASS_åä¸ºâ€œtext S_txt2&quot;çš„å†…å®¹</span><br><span class="line">                    div_all = soup.find_all(&quot;div&quot;, class_=&quot;text S_txt2&quot;)</span><br><span class="line">                    # å»ºä¸€ä¸ªåˆ—è¡¨æ¥å­˜</span><br><span class="line">                    time_all = []</span><br><span class="line">                    # éå†å­˜ï¼Œè¿ç»­åœ°å†™åˆ°åˆ—è¡¨ä¸­</span><br><span class="line">                    for div in div_all:</span><br><span class="line">                        text = div.get_text(strip=True)  # ä½¿ç”¨strip=Trueå»é™¤æ–‡æœ¬å‰åçš„ç©ºç™½å­—ç¬¦</span><br><span class="line">                        time_all.append(text)</span><br><span class="line"></span><br><span class="line">                    # ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æå–æ—¶é—´éƒ¨åˆ†ï¼Œç¬¦åˆè¯¥æ ¼å¼çš„æ‰ä¼šè¢«æå–å‡ºæ¥ï¼Œå¯ä»¥çœ‹åˆ°&#123;&#125;å†…çš„ä½¿æˆ‘ä»¬æå–çš„ä¿¡æ¯</span><br><span class="line">                    pattern_Q = r&#x27;(\d&#123;2&#125;-\d&#123;2&#125; \d&#123;2&#125;:\d&#123;2&#125; )æé—®&#x27;</span><br><span class="line">                    pattern_A = r&#x27;(\d&#123;2&#125;-\d&#123;2&#125; \d&#123;2&#125;:\d&#123;2&#125; )å›ç­”&#x27;</span><br><span class="line"></span><br><span class="line">                    # ç„¶åå†ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æå–æ—¶é—´éƒ¨åˆ†</span><br><span class="line">                    for time_text in time_all:</span><br><span class="line">                        match_A = re.search(pattern_A, time_text)</span><br><span class="line">                        match_Q = re.search(pattern_Q, time_text)</span><br><span class="line"></span><br><span class="line">                        if match_A:</span><br><span class="line">                            # è·å–answerå›ç­”çš„æ—¶é—´</span><br><span class="line">                            time_answer = match_A.group(1)</span><br><span class="line">                            print(time_answer)</span><br><span class="line">                            # ä½ è¦æ’å…¥çš„è¡Œå·</span><br><span class="line">                            row_number = row_index</span><br><span class="line">                            # row_number = 2</span><br><span class="line">                            # å°†å›ç­”çš„æ—¶é—´å¡«å†™åˆ°å¯¹åº”è¡Œçš„ç¬¬10åˆ—å•å…ƒæ ¼ä¸­</span><br><span class="line">                            ws.cell(row=row_number, column=10, value=time_answer)</span><br><span class="line">                            # ä¿å­˜å·¥ä½œè¡¨</span><br><span class="line">                            wb.save(excel_name)</span><br><span class="line"></span><br><span class="line">                        if match_Q:</span><br><span class="line">                            # è·å–questionæé—®çš„æ—¶é—´</span><br><span class="line">                            time_ask = match_Q.group(1)</span><br><span class="line">                            print(time_ask)</span><br><span class="line"></span><br><span class="line">                            # å‡è®¾ä½ è¦æ’å…¥çš„è¡Œå·æ˜¯2ï¼ˆç¤ºä¾‹ï¼‰</span><br><span class="line">                            row_number = row_index</span><br><span class="line">                            # row_number = 2</span><br><span class="line"></span><br><span class="line">                            # å°†æé—®çš„æ—¶é—´å¡«å†™åˆ°å¯¹åº”è¡Œçš„ç¬¬9åˆ—å•å…ƒæ ¼ä¸­</span><br><span class="line">                            ws.cell(row=row_number, column=9, value=time_ask)</span><br><span class="line">                            # ä¿å­˜å·¥ä½œè¡¨</span><br><span class="line">                            wb.save(excel_name)</span><br><span class="line"></span><br><span class="line">                    # time.sleep(1)</span><br><span class="line"></span><br><span class="line">    if count &gt;= 5:</span><br><span class="line">        wb.save(&quot;./many/&quot; + excel_name)</span><br><span class="line">    # ä¿å­˜å·¥ä½œè¡¨</span><br><span class="line">    else:</span><br><span class="line">        wb.save(&quot;./less/&quot; + excel_name)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    file_path = r&quot;./merged_file.xlsx&quot;</span><br><span class="line">    # è¯»å–Excelæ–‡ä»¶çš„ç¬¬2è¡Œçš„ç¬¬ä¸€åˆ—æ•°æ®</span><br><span class="line">    df = pd.read_excel(file_path, usecols=[0], header=None)</span><br><span class="line">    ids = df.iloc[292:350, 0].tolist()</span><br><span class="line">    print(ids, &quot;\n&quot;)</span><br><span class="line">    # è°ƒç”¨run()å‡½æ•°</span><br><span class="line">    for id in ids:</span><br><span class="line">        try:</span><br><span class="line">            print(id, type(id))</span><br><span class="line">            # run(str(id) + &#x27;.xlsx&#x27;)</span><br><span class="line">            name = &quot;&#123;&#125;&quot;.format(id) + &quot;.xlsx&quot;</span><br><span class="line">            print(name, type(name), &quot;\n&quot;)</span><br><span class="line">            run(name=name)</span><br><span class="line"></span><br><span class="line">        except:</span><br><span class="line">            continue</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="End-Note"><a href="#End-Note" class="headerlink" title="End Note"></a>End Note</h3><p>ä»…ä»…å¦‚æ­¤ï¼Œç®€å•çš„ä¸€ä¸ªå°ä½œåŠæ‰‹æ“easyä»£ç å®Œæˆï¼Œèƒ½è·‘å°±è¡Œã€‚ç•¥æ˜¾æ½¦è‰ï¼Œåç»­æœ‰å…´è¶£å¯ä»¥è¿›è¡Œä¸‹ä¸€æ­¥çš„æ•°æ®æ¸…æ´—ã€å­˜å‚¨æ•°æ®åº“ã€è¿›è¡Œååçˆ¬ç­‰ã€‚</p>
]]></content>
      <categories>
        <category>Project</category>
        <category>çˆ¬è™«</category>
      </categories>
      <tags>
        <tag>é¡¹ç›®å®è·µ</tag>
      </tags>
  </entry>
  <entry>
    <title>Hello World</title>
    <url>/2024/02/22/hello-world/</url>
    <content><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<span id="more"></span>

<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>
]]></content>
  </entry>
</search>
